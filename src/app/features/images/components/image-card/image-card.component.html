<div class="bg-zinc-900 border border-zinc-700/50 rounded-xl p-4 flex flex-col h-full hover:bg-zinc-800 transition-colors">
  <!-- Header -->
  <div class="flex items-start justify-between gap-2 mb-3">
    <div class="flex-1 min-w-0">
      <h3 class="font-medium text-white truncate" [title]="fullName()">
        {{ fullName() }}
      </h3>
      <div class="flex items-center gap-2 mt-1">
        <button
          type="button"
          (click)="copyId()"
          class="flex items-center gap-1 text-xs text-zinc-500 hover:text-zinc-300 transition-colors"
          title="Click to copy full ID"
        >
          <span class="font-mono">{{ shortId() }}</span>
          <lucide-icon [img]="Copy" class="w-3 h-3"></lucide-icon>
        </button>
      </div>
    </div>

    <!-- Delete button -->
    <button
      type="button"
      (click)="onDelete($event)"
      [disabled]="isDeleting() || containerCount() > 0"
      class="p-1.5 rounded-lg hover:bg-zinc-700 text-zinc-400 hover:text-red-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
      [title]="containerCount() > 0 ? 'Cannot delete: image in use' : 'Delete image'"
    >
      <lucide-icon
        [img]="Trash2"
        class="w-4 h-4"
        [class.animate-pulse]="isDeleting()"
      ></lucide-icon>
    </button>
  </div>

  <!-- Size and Created -->
  <div class="flex items-center gap-4 text-xs text-zinc-400 mb-3">
    <div class="flex items-center gap-1.5">
      <lucide-icon [img]="Package" class="w-3.5 h-3.5"></lucide-icon>
      <span>{{ sizeHuman() }}</span>
    </div>
    @if (relativeTime()) {
      <div class="flex items-center gap-1.5">
        <lucide-icon [img]="Clock" class="w-3.5 h-3.5"></lucide-icon>
        <span>{{ relativeTime() }}</span>
      </div>
    }
  </div>

  <!-- Status badges -->
  <div class="flex flex-wrap gap-1.5 mb-3">
    @if (isDangling()) {
      <span class="px-2 py-0.5 text-xs rounded-full bg-orange-500/20 text-orange-400 border border-orange-500/30">
        Dangling
      </span>
    }
    @if (isUnused() && !isDangling()) {
      <span class="px-2 py-0.5 text-xs rounded-full bg-yellow-500/20 text-yellow-400 border border-yellow-500/30">
        Unused
      </span>
    }
    @if (containerCount() > 0) {
      <span class="px-2 py-0.5 text-xs rounded-full bg-green-500/20 text-green-400 border border-green-500/30">
        {{ containerCount() }} {{ containerCount() === 1 ? 'container' : 'containers' }}
      </span>
    }
  </div>

  <!-- Architecture -->
  @if (archDisplay()) {
    <div class="flex items-center gap-1.5 text-xs text-zinc-500 mb-3">
      <lucide-icon [img]="Cpu" class="w-3.5 h-3.5"></lucide-icon>
      <span>{{ archDisplay() }}</span>
    </div>
  }

  <!-- Digest -->
  @if (truncatedDigest()) {
    <button
      type="button"
      (click)="copyDigest()"
      class="text-xs text-zinc-600 hover:text-zinc-400 font-mono mb-3 text-left transition-colors"
      title="Click to copy digest"
    >
      {{ truncatedDigest() }}
    </button>
  }

  <!-- Container chips -->
  <div class="flex-1">
    @if (containerCount() > 0) {
      <div class="flex flex-wrap gap-1.5">
        @for (container of containers(); track container.id) {
          <app-container-chip
            [container]="container"
            [removable]="false"
            [compact]="true"
          />
        }
      </div>
    } @else {
      <div class="text-xs text-zinc-500 italic">No containers using this image</div>
    }
  </div>
</div>
